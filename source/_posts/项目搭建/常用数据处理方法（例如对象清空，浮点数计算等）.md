---
title: 常用数据处理方法（例如对象清空，浮点数计算等）
date: 2023-04-20 14:12
tags: [js常用方法]
categories: 前端随笔
---



# 一、对象清空 resetData

```js
/**
 * @description 对象清空
 * @param {object} valueObj  传入的要清空的对象
 * @return Object
 */
export const resetData = (valueObj: any) => {
	if (Object.prototype.toString.call(valueObj) === '[object Object]') {
		const keys = Object.keys(valueObj)
		const obj: { [name: string]: string | Array<any> | boolean | number } = {}
		keys.forEach(item => {
			obj[item] =
				Object.prototype.toString.call(valueObj[item]) === '[object Array]'
					? []
					: typeof valueObj[item] === 'number'
					? 0
					: typeof valueObj[item] === 'boolean'
					? false
					: ''
		})
		Object.assign(valueObj, obj)
	} else {
		const keys = Object.keys(valueObj[0])
		const obj: { [name: string]: string | Array<any> | boolean | number } = {}
		keys.forEach(item => {
			obj[item] =
				Object.prototype.toString.call(valueObj[item]) === '[object Array]'
					? []
					: typeof valueObj[item] === 'number'
					? 0
					: typeof valueObj[item] === 'boolean'
					? false
					: ''
		})
		Object.assign(valueObj[0], obj)
	}
}

```

# 二、js浮点数乘法处理

```js
/**
 *  js浮点数乘法处理
 * @param {} arg1
 * @param {*} arg2
 */
export const accMul = (arg1: number, arg2?: number) => {
	return arg2 ? Number(Number(arg1 * 100).toFixed(arg2)) : Number(Number(arg1 * 100).toFixed(2))
}
```

# 三、js浮点数除法处理
# 
```js
/**
 * js 浮点数除法处理
 * @param {*} arg1
 * @param {*} arg2
 */
export const accDiv = (arg1: number, arg2?: number) => {
	return arg2 ? Number(Number(arg1 / 100).toFixed(arg2)) : Number(Number(arg1 / 100).toFixed(2))
}
```

# 四、数字转金额格式

```js
/**
 * 数字转金额格式
 * @param num 要格式化的数字
 * @param decimals 保留位数
 */
export const numberToMoney = (num: number | BigNumber, decimals = 2, thousandsSep = ','): string => {
	if (isNaN(num as any)) {
		return ''
	}
	const prec = !isFinite(+decimals) ? 0 : Math.abs(decimals) // 保留的位数一定是有限位数的正整数
	const sep = typeof thousandsSep === 'undefined' ? ',' : thousandsSep
	const s = new BigNumber(num).toString().replace(/,/g, '') // 字符串，将，变成'';
	const p = new BigNumber(s) // 解析一个字符串，并返回一个浮点数
	const n = p.isNaN() ? 1 : p
	const formatNum = n
		.toFixed(prec)
		.toString()
		.replace(/(\d)(?=(\d{3})+\.)/g, function ($0, $1) {
			return $1 + sep
		})
	return num ? formatNum : ''
}
```

# 五、时间戳转日期格式

```js
type dateFormats = 'y-M-d' | 'y-M-d H:m:s' | 'y年M月d日' | 'y年M月d日 H时i分'

/**
 * 时间戳转日期格式
 * @param timestape
 * @param time
 * @returns
 */
export const dateFormat = (timestape: number, formats: dateFormats = 'y-M-d H:m:s'): string => {
	if (!timestape) {
		return ''
	}
	// 补零
	const zero = (val: number): string | number => {
		return val < 10 ? `0${val}` : val
	}
	const myDate = new Date(timestape)
	const year = myDate.getFullYear()
	const month = zero(myDate.getMonth() + 1)
	const day = zero(myDate.getDate())
	const hour = zero(myDate.getHours())
	const minute = zero(myDate.getMinutes())
	const second = zero(myDate.getSeconds())
	// 替换 formats 中的内容
	const replaceDate = (match: string): string => {
		return (
			{
				y: year,
				M: month,
				d: day,
				H: hour,
				m: minute,
				s: second
			} as any
		)[match]
	}
	return formats.replace(/Y|M|d|H|m|s/gi, replaceDate)
}
```