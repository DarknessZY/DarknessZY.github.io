---
title: 计算机网络阅读笔记
date: 2024-02-18 16:36
tags: [图书笔记]
categories: 图书笔记
---

# 前言
> 了解一下计算机网络相关的，主要是了解一些基础知识，也不会深入学习，所以看的是小林coding的图解网络和菜鸟教程

# 1. 网络层次划分
为了使不同计算机厂家生产的计算机能够相互通信，以便在更大的范围内建立计算机网络，国际标准化组织（ISO）在1978年提出了"开放系统互联参考模型"，即著名的OSI/RM七层模型（Open System Interconnection/Reference Model）。它将计算机网络体系结构的通信协议划分为七层，自下而上依次为：物理层（Physics Layer）、数据链路层（Data Link Layer）、网络层（Network Layer）、传输层（Transport Layer）、会话层（Session Layer）、表示层（Presentation Layer）、应用层（Application Layer）。其中第四层完成数据传送服务，上面三层面向用户。

除了标准的OSI七层模型以外，常见的网络层次划分还有TCP/IP四层协议以及TCP/IP五层协议，它们之间的对应关系如下图所示：

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ca505690d12d47a4a50df3193557ca0b~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=750&h=470&s=206394&e=png&b=fcfafa)
# 2. Tcp/IP 四层网络模型？
## 应用层
最上层的，也是我们能直接接触到的就是应用层，我们电脑或手机使用的应用软件都是在应用层实现。那么，当两个不同设备的应用需要通信的时候，应用就把应用数据传给下一层，也就是传输层。
所以，应用层只需要专注于为用户提供应用功能，比如 HTTP、FTP、Telnet、DNS、SMTP等。
应用层是不用去关心数据是如何传输的，就类似于，我们寄快递的时候，只需要把包裹交给快递员，由他负责运输快递，我们不需要关心快递是如何被运输的。
而且应用层是工作在操作系统中的用户态，传输层及以下则工作在内核态。

## 传输层
应用层的数据包会传给传输层，**传输层**（*Transport Layer*）是为应用层提供网络支持的。

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c77135dc2ffc45219d65c0d0cfb73fc7~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=602&h=287&s=35843&e=png&b=fffefe)

在传输层会有两个传输协议，分别是 TCP 和 UDP。

TCP 的全称叫传输控制协议（*Transmission Control Protocol*），大部分应用使用的正是 TCP 传输层协议，比如 HTTP 应用层协议。TCP 相比 UDP 多了很多特性，比如流量控制、超时重传、拥塞控制等，这些都是为了保证数据包能可靠地传输给对方。

UDP 相对来说就很简单，简单到只负责发送数据包，不保证数据包是否能抵达对方，但它实时性相对更好，传输效率也高。当然，UDP 也可以实现可靠传输，把 TCP 的特性在应用层上实现就可以，不过要实现一个商用的可靠 UDP 传输协议，也不是一件简单的事情。

应用需要传输的数据可能会非常大，如果直接传输就不好控制，因此当传输层的数据包大小超过 MSS（TCP 最大报文段长度） ，就要将数据包分块，这样即使中途有一个分块丢失或损坏了，只需要重新发送这一个分块，而不用重新发送整个数据包。在 TCP 协议中，我们把每个分块称为一个 **TCP 段**（*TCP Segment*）。

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1beddd918a8847ab97c70c32ea049f33~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=581&h=392&s=41422&e=png&b=ffffff)

当设备作为接收方时，传输层要负责把数据包传个应用，但是一台设备上可能会用很多应用在接收或者传输数据，因此需要一个编号将应用区分开来，这个编号就是端口。
比如80端口通常是web服务器用的，22端口通常是远程登录服务器用的。而对于浏览器（客户端）中的每个标签栏都是一个独立的进程，操作系统会为这些进程分配临时的端口号。
由于传输层的报文会携带端口号，因此接收方可以识别出该报文是发送给哪个应用。

## 网络层
传输层可能大家刚接触的时候，会认为它负责将数据从一个设备传输到另一个设备，事实上它并不负责。

实际场景中的网络环节是错综复杂的，中间有各种各样的线路和分叉路口，如果一个设备的数据要传输给另一个设备，就需要在各种各样的路径和节点进行选择，而传输层的设计理念是简单、高效、专注，如果传输层还负责这一块功能就有点违背设计原则了。

也就是说，我们不希望传输层协议处理太多的事情，只需要服务好应用即可，让其作为应用间数据传输的媒介，帮助实现应用到应用的通信，而实际的传输功能就交给下一层，也就是**网络层**（*Internet Layer*）。

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cfbe1e0f9094483fb44d7a63e79fe318~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=602&h=467&s=63402&e=png&b=fff9f9)

网络层最常使用的是IP协议（Internet Protocol），IP协议会将传输层的报文作为数据部分，再加上 IP 包头组装成 IP 报文，如果 IP 报文大小超过 MTU（以太网中一般为 1500 字节）就会**再次进行分片**，得到一个即将发送到网络的 IP 报文。

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c28e3c78ef4b494a952d438d4d44cd2d~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1142&h=702&s=293820&e=png&b=fefafa)

网络层负责将数据从一个设备传输到另一个设备，世界上那么多设备，又该如何找到对方呢？因此，网络层需要有区分设备的编号。

我们一般用 IP 地址给设备进行编号，对于 IPv4 协议， IP 地址共 32 位，分成了四段（比如，192.168.100.1），每段是 8 位。只有一个单纯的 IP 地址虽然做到了区分设备，但是寻址起来就特别麻烦，全世界那么多台设备，难道一个一个去匹配？这显然不科学。

因此，需要将 IP 地址分成两种意义：

-   一个是**网络号**，负责标识该 IP 地址是属于哪个「子网」的；
-   一个是**主机号**，负责标识同一「子网」下的不同主机；

怎么分的呢？这需要配合**子网掩码**才能算出 IP 地址 的网络号和主机号。
举个例子，比如10.100.122.0/24，后面的`/24`表示就是 `255.255.255.0` 子网掩码，255.255.255.0 二进制是「11111111-11111111-11111111-00000000」，大家数数一共多少个1？不用数了，是 24 个1，为了简化子网掩码的表示，用/24代替255.255.255.0。

知道了子网掩码，该怎么计算出网络地址和主机地址呢？

网络号： IP地址转二进制和子网掩码转二进制后做AND运算

主机号： 将子网掩码取反后与ip地址进行按位与运算

那么在寻址的过程中，先匹配到相同的网络号（表示要找到同一个子网），才会去找对应的主机。

除了寻址能力， IP 协议还有另一个重要的能力就是**路由**。

实际场景中，两台设备并不是用一条网线连接起来的，而是通过很多网关、路由器、交换机等众多网络设备连接起来的，那么就会形成很多条网络的路径，因此当数据包到达一个网络节点，就需要通过路由算法决定下一步走哪条路径。

路由器寻址工作中，就是要找到目标地址的子网，找到后进而把数据包转发给对应的网络内。

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9128df9bc3eb451cb29e22e01aa03272~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=684&h=542&s=172651&e=png&b=fefdfd)
所以，**IP 协议的寻址作用是告诉我们去往下一个目的地该朝哪个方向走，路由则是根据「下一个目的地」选择路径。寻址更像在导航，路由更像在操作方向盘**

## 网络接口层
生成了 IP 头部之后，接下来要交给**网络接口层**（*Link Layer*）在 IP 头部的前面加上 MAC 头部，并封装成数据帧（Data frame）发送到网络上。

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b9d8469854f2420f9f11c2e0e02b2901~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=602&h=647&s=82533&e=png&b=fef8f8)

## 总结

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9e7706225349498c9a79580e1b22186e~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=905&h=501&s=125669&e=png&b=fdf5f3)
# 参考文章
[图解网络介绍 | 小林coding (xiaolincoding.com)](https://xiaolincoding.com/network/#%E9%80%82%E5%90%88%E4%BB%80%E4%B9%88%E7%BE%A4%E4%BD%93)

[计算机网络基础知识总结 | 菜鸟教程 (runoob.com)](https://www.runoob.com/w3cnote/summary-of-network.html)